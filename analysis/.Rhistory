legend.position = "bottom")
all_mean_shift_plot
in_srs_comb_plot <- in_srs_plot+all_mean_shift_plot+plot_layout(guides="collect", width=c(2,1))&
theme(legend.position="bottom")
in_srs_comb_plot
#
#
# diff_pos_counts <- mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(extreme_pos, fn) %>%
#   summarise(count=n()) %>%
#   filter(extreme_pos != "no_difference")
#
#
# # Count positions inside or outside of SRSs
# total_srs = mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(fn) %>%
#   summarise(count=n()) %>%
#   mutate(extreme_pos = "whole_protein")
#
# # Combine 2C19/2C9 enriched SRS vs no_srs with counts from whole protein
# diff_pos_counts <- rbind(diff_pos_counts, total_srs)
#
#
# total_srs_calc <- total_srs %>%
#   ungroup() %>%
#   pivot_wider(names_from=fn, values_from=count)
#
# total_srs_frac = total_srs_calc$srs / (total_srs_calc$srs + total_srs_calc$no_srs)
#
#
# srs_enrichments <- diff_pos_counts %>%
#   pivot_wider(names_from=fn, values_from=count) %>%
#   mutate(frac_srs = (srs/(srs+no_srs))) %>%
#   mutate(frac_norm = frac_srs / total_srs_frac) %>%
#   filter(extreme_pos != "no_difference") %>%
#   mutate(frac_norm = replace_na(frac_norm, 0))
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot+plot_layout(widths=c(2, 2, 3))
fig3_bot
ggsave("../figures/fig3_bottom.png", height=6, width=12.5, unit="in", plot=fig3_bot)
mDMS_heatmap_df_shifts_position_mean_enrich <- mDMS_heatmap_df_shifts_position_mean_srs %>%
mutate(extreme_pos = case_when(position %in% FDR_corrected$position & mean_shift > 0 ~ "2c19_more_tolerant",
position %in% FDR_corrected$position & mean_shift < 0 ~ "2c19_less_tolerant",
TRUE ~ "no_difference")) %>%
mutate(name = replace_na(name, "no_srs"),
fn = replace_na(fn, "no_srs"))
significance_colors <- list("2c19_more_tolerant" = "red",
"2c19_less_tolerant" = "blue",
"no_difference" = "gray40")
in_srs_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x=fn, y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Outside SRS", "In SRS"))+
labs(y="Mean shift\n(position)",
color="Mutational tolerance")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom")
in_srs_plot
all_mean_shift_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x="1", y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Whole protein"))+
labs(y="Mean shift\n(position)",
color="Mutational tolerance")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom")
all_mean_shift_plot
in_srs_comb_plot <- in_srs_plot+all_mean_shift_plot+plot_layout(guides="collect", width=c(2,1))&
theme(legend.position="bottom")
in_srs_comb_plot
#
#
# diff_pos_counts <- mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(extreme_pos, fn) %>%
#   summarise(count=n()) %>%
#   filter(extreme_pos != "no_difference")
#
#
# # Count positions inside or outside of SRSs
# total_srs = mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(fn) %>%
#   summarise(count=n()) %>%
#   mutate(extreme_pos = "whole_protein")
#
# # Combine 2C19/2C9 enriched SRS vs no_srs with counts from whole protein
# diff_pos_counts <- rbind(diff_pos_counts, total_srs)
#
#
# total_srs_calc <- total_srs %>%
#   ungroup() %>%
#   pivot_wider(names_from=fn, values_from=count)
#
# total_srs_frac = total_srs_calc$srs / (total_srs_calc$srs + total_srs_calc$no_srs)
#
#
# srs_enrichments <- diff_pos_counts %>%
#   pivot_wider(names_from=fn, values_from=count) %>%
#   mutate(frac_srs = (srs/(srs+no_srs))) %>%
#   mutate(frac_norm = frac_srs / total_srs_frac) %>%
#   filter(extreme_pos != "no_difference") %>%
#   mutate(frac_norm = replace_na(frac_norm, 0))
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot+plot_layout(widths=c(2, 2, 3))
fig3_bot
ggsave("../figures/fig3_bottom.png", height=6, width=12.5, unit="in", plot=fig3_bot)
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot
fig3_bot
ggsave("../figures/fig3_bottom.png", height=6, width=15, unit="in", plot=fig3_bot)
set.seed(1234)
mDMS_heatmap_df_shifts_position_mean_enrich <- mDMS_heatmap_df_shifts_position_mean_srs %>%
mutate(extreme_pos = case_when(position %in% FDR_corrected$position & mean_shift > 0 ~ "2c19_more_tolerant",
position %in% FDR_corrected$position & mean_shift < 0 ~ "2c19_less_tolerant",
TRUE ~ "no_difference")) %>%
mutate(name = replace_na(name, "no_srs"),
fn = replace_na(fn, "no_srs"))
significance_colors <- list("2c19_more_tolerant" = "red",
"2c19_less_tolerant" = "blue",
"no_difference" = "gray40")
in_srs_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x=fn, y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Outside SRS", "In SRS"))+
labs(y="Mean shift\n(position)",
color="Mutational tolerance")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom")
in_srs_plot
all_mean_shift_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x="1", y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Whole protein"))+
labs(y="Mean shift\n(position)",
color="Mutational tolerance")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom")
all_mean_shift_plot
in_srs_comb_plot <- in_srs_plot+all_mean_shift_plot+plot_layout(guides="collect", width=c(2,1))&
theme(legend.position="bottom")
in_srs_comb_plot
#
#
# diff_pos_counts <- mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(extreme_pos, fn) %>%
#   summarise(count=n()) %>%
#   filter(extreme_pos != "no_difference")
#
#
# # Count positions inside or outside of SRSs
# total_srs = mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(fn) %>%
#   summarise(count=n()) %>%
#   mutate(extreme_pos = "whole_protein")
#
# # Combine 2C19/2C9 enriched SRS vs no_srs with counts from whole protein
# diff_pos_counts <- rbind(diff_pos_counts, total_srs)
#
#
# total_srs_calc <- total_srs %>%
#   ungroup() %>%
#   pivot_wider(names_from=fn, values_from=count)
#
# total_srs_frac = total_srs_calc$srs / (total_srs_calc$srs + total_srs_calc$no_srs)
#
#
# srs_enrichments <- diff_pos_counts %>%
#   pivot_wider(names_from=fn, values_from=count) %>%
#   mutate(frac_srs = (srs/(srs+no_srs))) %>%
#   mutate(frac_norm = frac_srs / total_srs_frac) %>%
#   filter(extreme_pos != "no_difference") %>%
#   mutate(frac_norm = replace_na(frac_norm, 0))
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot
fig3_bot
ggsave("../figures/fig3_bottom.png", height=6, width=15, unit="in", plot=fig3_bot)
set.seed(1234)
mDMS_heatmap_df_shifts_position_mean_enrich <- mDMS_heatmap_df_shifts_position_mean_srs %>%
mutate(extreme_pos = case_when(position %in% FDR_corrected$position & mean_shift > 0 ~ "2c19_more_tolerant",
position %in% FDR_corrected$position & mean_shift < 0 ~ "2c19_less_tolerant",
TRUE ~ "no_difference")) %>%
mutate(name = replace_na(name, "no_srs"),
fn = replace_na(fn, "no_srs"))
significance_colors <- list("2c19_more_tolerant" = "red",
"2c19_less_tolerant" = "blue",
"no_difference" = "gray40")
in_srs_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x=fn, y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Outside SRS", "In SRS"))+
labs(y="Mean shift value\n(position)",
color="Mutational tolerance")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom")
in_srs_plot
all_mean_shift_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x="1", y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Whole protein"))+
labs(y="Mean shift value\n(position)",
color="Mutational tolerance")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom")
all_mean_shift_plot
in_srs_comb_plot <- in_srs_plot+all_mean_shift_plot+plot_layout(guides="collect", width=c(2,1))&
theme(legend.position="bottom")
in_srs_comb_plot
#
#
# diff_pos_counts <- mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(extreme_pos, fn) %>%
#   summarise(count=n()) %>%
#   filter(extreme_pos != "no_difference")
#
#
# # Count positions inside or outside of SRSs
# total_srs = mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(fn) %>%
#   summarise(count=n()) %>%
#   mutate(extreme_pos = "whole_protein")
#
# # Combine 2C19/2C9 enriched SRS vs no_srs with counts from whole protein
# diff_pos_counts <- rbind(diff_pos_counts, total_srs)
#
#
# total_srs_calc <- total_srs %>%
#   ungroup() %>%
#   pivot_wider(names_from=fn, values_from=count)
#
# total_srs_frac = total_srs_calc$srs / (total_srs_calc$srs + total_srs_calc$no_srs)
#
#
# srs_enrichments <- diff_pos_counts %>%
#   pivot_wider(names_from=fn, values_from=count) %>%
#   mutate(frac_srs = (srs/(srs+no_srs))) %>%
#   mutate(frac_norm = frac_srs / total_srs_frac) %>%
#   filter(extreme_pos != "no_difference") %>%
#   mutate(frac_norm = replace_na(frac_norm, 0))
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot
fig3_bot
ggsave("../figures/fig3_bottom.png", height=6, width=15, unit="in", plot=fig3_bot)
design_layout <- "
11111#22222
3333333333#
4444444444#
"
fig3 <- corrplot_2C19_2C9+shift_density_no0+comb_roll+fig3_bot+plot_layout(design=design_layout)
fig3
ggsave(plot=fig3, "../figures/fig3.png", height=16, width=12.5, unit="in")
ggsave(plot=fig3, "../figures/fig3.svg", height=16, width=12.5, unit="in")
design_layout <- "
11111#22222
3333333333#
44444444444
"
fig3 <- corrplot_2C19_2C9+shift_density_no0+comb_roll+fig3_bot+plot_layout(design=design_layout)
fig3
ggsave(plot=fig3, "../figures/fig3.png", height=16, width=12.5, unit="in")
ggsave(plot=fig3, "../figures/fig3.svg", height=16, width=12.5, unit="in")
set.seed(1234)
mDMS_heatmap_df_shifts_position_mean_enrich <- mDMS_heatmap_df_shifts_position_mean_srs %>%
mutate(extreme_pos = case_when(position %in% FDR_corrected$position & mean_shift > 0 ~ "2c19_more_tolerant",
position %in% FDR_corrected$position & mean_shift < 0 ~ "2c19_less_tolerant",
TRUE ~ "no_difference")) %>%
mutate(name = replace_na(name, "no_srs"),
fn = replace_na(fn, "no_srs"))
significance_colors <- list("2c19_more_tolerant" = "red",
"2c19_less_tolerant" = "blue",
"no_difference" = "gray40")
in_srs_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x=fn, y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Outside SRS", "In SRS"))+
labs(y="Mean shift value\n(position)",
color="Mutational tolerance")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom")
in_srs_plot
all_mean_shift_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x="1", y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Whole protein"))+
labs(color="Mutational tolerance")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
axis.title.y = element_blank(),
legend.position = "bottom")
all_mean_shift_plot
in_srs_comb_plot <- in_srs_plot+all_mean_shift_plot+plot_layout(guides="collect", width=c(2,1))&
theme(legend.position="bottom")
in_srs_comb_plot
#
#
# diff_pos_counts <- mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(extreme_pos, fn) %>%
#   summarise(count=n()) %>%
#   filter(extreme_pos != "no_difference")
#
#
# # Count positions inside or outside of SRSs
# total_srs = mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(fn) %>%
#   summarise(count=n()) %>%
#   mutate(extreme_pos = "whole_protein")
#
# # Combine 2C19/2C9 enriched SRS vs no_srs with counts from whole protein
# diff_pos_counts <- rbind(diff_pos_counts, total_srs)
#
#
# total_srs_calc <- total_srs %>%
#   ungroup() %>%
#   pivot_wider(names_from=fn, values_from=count)
#
# total_srs_frac = total_srs_calc$srs / (total_srs_calc$srs + total_srs_calc$no_srs)
#
#
# srs_enrichments <- diff_pos_counts %>%
#   pivot_wider(names_from=fn, values_from=count) %>%
#   mutate(frac_srs = (srs/(srs+no_srs))) %>%
#   mutate(frac_norm = frac_srs / total_srs_frac) %>%
#   filter(extreme_pos != "no_difference") %>%
#   mutate(frac_norm = replace_na(frac_norm, 0))
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot
fig3_bot
ggsave("../figures/fig3_bottom.png", height=6, width=15, unit="in", plot=fig3_bot)
design_layout <- "
11111#22222
3333333333#
44444444444
"
fig3 <- corrplot_2C19_2C9+shift_density_no0+comb_roll+fig3_bot+plot_layout(design=design_layout)
fig3
ggsave(plot=fig3, "../figures/fig3.png", height=16, width=12.5, unit="in")
ggsave(plot=fig3, "../figures/fig3.svg", height=16, width=12.5, unit="in")
all_mean_shift_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x="1", y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Whole protein"))+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
axis.title.y = element_blank(),
legend.position = "bottom",
legend.title=element_blank())
set.seed(1234)
mDMS_heatmap_df_shifts_position_mean_enrich <- mDMS_heatmap_df_shifts_position_mean_srs %>%
mutate(extreme_pos = case_when(position %in% FDR_corrected$position & mean_shift > 0 ~ "2c19_more_tolerant",
position %in% FDR_corrected$position & mean_shift < 0 ~ "2c19_less_tolerant",
TRUE ~ "no_difference")) %>%
mutate(name = replace_na(name, "no_srs"),
fn = replace_na(fn, "no_srs"))
significance_colors <- list("2c19_more_tolerant" = "red",
"2c19_less_tolerant" = "blue",
"no_difference" = "gray40")
in_srs_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x=fn, y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Outside SRS", "In SRS"))+
labs(y="Mean shift value\n(position)")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom",
legend.title = element_blank())
in_srs_plot
all_mean_shift_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x="1", y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Whole protein"))+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
axis.title.y = element_blank(),
legend.position = "bottom",
legend.title=element_blank())
all_mean_shift_plot
in_srs_comb_plot <- in_srs_plot+all_mean_shift_plot+plot_layout(guides="collect", width=c(2,1))&
theme(legend.position="bottom")
in_srs_comb_plot
#
#
# diff_pos_counts <- mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(extreme_pos, fn) %>%
#   summarise(count=n()) %>%
#   filter(extreme_pos != "no_difference")
#
#
# # Count positions inside or outside of SRSs
# total_srs = mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(fn) %>%
#   summarise(count=n()) %>%
#   mutate(extreme_pos = "whole_protein")
#
# # Combine 2C19/2C9 enriched SRS vs no_srs with counts from whole protein
# diff_pos_counts <- rbind(diff_pos_counts, total_srs)
#
#
# total_srs_calc <- total_srs %>%
#   ungroup() %>%
#   pivot_wider(names_from=fn, values_from=count)
#
# total_srs_frac = total_srs_calc$srs / (total_srs_calc$srs + total_srs_calc$no_srs)
#
#
# srs_enrichments <- diff_pos_counts %>%
#   pivot_wider(names_from=fn, values_from=count) %>%
#   mutate(frac_srs = (srs/(srs+no_srs))) %>%
#   mutate(frac_norm = frac_srs / total_srs_frac) %>%
#   filter(extreme_pos != "no_difference") %>%
#   mutate(frac_norm = replace_na(frac_norm, 0))
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot
fig3_bot
ggsave("../figures/fig3_bottom.png", height=6, width=15, unit="in", plot=fig3_bot)
design_layout <- "
11111#22222
3333333333#
44444444444
"
fig3 <- corrplot_2C19_2C9+shift_density_no0+comb_roll+fig3_bot+plot_layout(design=design_layout)
fig3
ggsave(plot=fig3, "../figures/fig3.png", height=16, width=12.5, unit="in")
ggsave(plot=fig3, "../figures/fig3.svg", height=16, width=12.5, unit="in")
set.seed(1234)
mDMS_heatmap_df_shifts_position_mean_enrich <- mDMS_heatmap_df_shifts_position_mean_srs %>%
mutate(extreme_pos = case_when(position %in% FDR_corrected$position & mean_shift > 0 ~ "2c19_more_tolerant",
position %in% FDR_corrected$position & mean_shift < 0 ~ "2c19_less_tolerant",
TRUE ~ "no_difference")) %>%
mutate(name = replace_na(name, "no_srs"),
fn = replace_na(fn, "no_srs"))
significance_colors <- list("2c19_more_tolerant" = "red",
"2c19_less_tolerant" = "blue",
"no_difference" = "gray40")
in_srs_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x=fn, y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Outside SRS", "In SRS"))+
labs(y="Mean shift value\n(position)")+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
legend.position = "bottom",
legend.title = element_blank())
in_srs_plot
all_mean_shift_plot <- ggplot(mDMS_heatmap_df_shifts_position_mean_enrich, aes(x="1", y=mean_shift, color=extreme_pos))+
geom_jitter(alpha=0.5)+
scale_color_manual(values = significance_colors,
labels=c("CYP2C19 more tolerant", "CYP2C19 less tolerant", "Insignificant difference"))+
scale_x_discrete(labels=c("Whole protein"))+
theme(axis.title.x = element_blank(),
axis.text.x=element_text(angle=45, vjust=1, hjust=1),
axis.title.y = element_blank(),
axis.text.y= element_blank(),
legend.position = "bottom",
legend.title=element_blank())
all_mean_shift_plot
in_srs_comb_plot <- in_srs_plot+all_mean_shift_plot+plot_layout(guides="collect", width=c(2,1))&
theme(legend.position="bottom")
in_srs_comb_plot
#
#
# diff_pos_counts <- mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(extreme_pos, fn) %>%
#   summarise(count=n()) %>%
#   filter(extreme_pos != "no_difference")
#
#
# # Count positions inside or outside of SRSs
# total_srs = mDMS_heatmap_df_shifts_position_mean_enrich %>%
#   group_by(fn) %>%
#   summarise(count=n()) %>%
#   mutate(extreme_pos = "whole_protein")
#
# # Combine 2C19/2C9 enriched SRS vs no_srs with counts from whole protein
# diff_pos_counts <- rbind(diff_pos_counts, total_srs)
#
#
# total_srs_calc <- total_srs %>%
#   ungroup() %>%
#   pivot_wider(names_from=fn, values_from=count)
#
# total_srs_frac = total_srs_calc$srs / (total_srs_calc$srs + total_srs_calc$no_srs)
#
#
# srs_enrichments <- diff_pos_counts %>%
#   pivot_wider(names_from=fn, values_from=count) %>%
#   mutate(frac_srs = (srs/(srs+no_srs))) %>%
#   mutate(frac_norm = frac_srs / total_srs_frac) %>%
#   filter(extreme_pos != "no_difference") %>%
#   mutate(frac_norm = replace_na(frac_norm, 0))
fig3_bot <- k_boxplot+shifts_in_SRS_heme_plot+in_srs_comb_plot
fig3_bot
ggsave("../figures/fig3_bottom.png", height=6, width=15, unit="in", plot=fig3_bot)
design_layout <- "
11111#22222
3333333333#
44444444444
"
fig3 <- corrplot_2C19_2C9+shift_density_no0+comb_roll+fig3_bot+plot_layout(design=design_layout)
fig3
ggsave(plot=fig3, "../figures/fig3.png", height=16, width=12.5, unit="in")
ggsave(plot=fig3, "../figures/fig3.svg", height=16, width=12.5, unit="in")
